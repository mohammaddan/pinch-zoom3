(function(n,o){typeof exports=="object"&&typeof module!="undefined"?o(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],o):(n=typeof globalThis!="undefined"?globalThis:n||self,o(n.moon={},n.Vue))})(this,function(n,o){"use strict";var g=(t,e)=>{const s=t.__vccOpts||t;for(const[l,f]of e)s[l]=f;return s};const a={name:"PinchZoom3",props:{image:{},width:{default:"100%"}},data(){return{touches:[],firstTouches:[],scale:1,top:0,left:0,leftOffset:0,topOffset:0,height:"250px",originWidth:300,originHeight:300,maxScale:2}},mounted(){if(this.image){let t=new Image;t.src=this.image;let e=this;t.onload=s=>{this.originHeight=t.height,this.originWidth=t.width;let l=this.$refs.pz.clientWidth,f=l*t.height/t.width;this.maxScale=2*this.originWidth/l,f&&(e.height=f+"px")}}},methods:{lineLength(t){let e=t[0].clientX-t[1].clientX,s=t[0].clientY-t[1].clientY;return Math.sqrt(e**2+s**2)},averagePoint(t){let e=(t[0].clientX+t[1].clientX)/2,s=(t[0].clientY+t[1].clientY)/2;return{left:e,top:s}},mouseWheel(t){let e=t.target.getBoundingClientRect(),s=this.scale;this.scale*=t.wheelDeltaY>0?1.1:.91,this.scale<1&&(this.scale=1),this.scale>this.maxScale&&(this.scale=this.maxScale),this.zoomImage(t.x-e.x,t.y-e.y,e.width,e.height,s,this.scale)},panStart(t){console.log(t),this.firstTouches=this.touches=[{clientX:t.clientX,clientY:t.clientY}]},gestureStart(t){var e,s;((e=t.touches)==null?void 0:e.length)>1?this.firstTouches=this.touches=t.touches:((s=t.touches)==null?void 0:s.length)===1&&(this.firstTouches=this.touches=t.touches)},panMove(t){var s,l;let e=t.target.getBoundingClientRect();if(((s=this.touches)==null?void 0:s.length)===1&&((l=this.firstTouches)==null?void 0:l.length)===1){let f=t;this.leftOffset-=f.clientX-this.firstTouches[0].clientX,this.leftOffset>e.width*(this.scale-1)&&(this.leftOffset=e.width*(this.scale-1)),this.leftOffset<0&&(this.leftOffset=0),this.topOffset-=f.clientY-this.firstTouches[0].clientY,this.topOffset>e.height*(this.scale-1)&&(this.topOffset=e.height*(this.scale-1)),this.topOffset<0&&(this.topOffset=0),this.firstTouches=[{clientX:t.clientX,clientY:t.clientY}]}},gestureMove(t){var s,l,f,i;let e=t.target.getBoundingClientRect();if(((s=this.touches)==null?void 0:s.length)>1&&((l=t.touches)==null?void 0:l.length)>1&&this.firstTouches.length>1){let h=this.scale,c=t.touches,r=Math.abs(this.lineLength(c)/this.lineLength(this.touches));this.touches=c;let u=this.averagePoint(this.touches);this.left=u.left-e.x,this.top=u.top-e.y,this.scale*=r,this.scale<1&&(this.scale=1),this.scale>this.maxScale&&(this.scale=this.maxScale),this.zoomImage(this.left,this.top,e.width,e.height,h,this.scale)}else if(((f=this.touches)==null?void 0:f.length)===1&&((i=t.touches)==null?void 0:i.length)===1&&this.firstTouches.length===1){let h=t.touches[0];this.leftOffset-=h.clientX-this.firstTouches[0].clientX,this.leftOffset>e.width*(this.scale-1)&&(this.leftOffset=e.width*(this.scale-1)),this.leftOffset<0&&(this.leftOffset=0),this.topOffset-=h.clientY-this.firstTouches[0].clientY,this.topOffset>e.height*(this.scale-1)&&(this.topOffset=e.height*(this.scale-1)),this.topOffset<0&&(this.topOffset=0),this.firstTouches=t.touches}},gestureEnd(){this.touches=[]},zoomImage(t,e,s,l,f,i){let h=i/f,c=(this.leftOffset+t)*h,r=(this.topOffset+e)*h;this.leftOffset=Math.max(0,c-t),this.topOffset=Math.max(0,r-e),this.leftOffset>s*(i-1)&&(this.leftOffset=s*(i-1)),this.topOffset>l*(i-1)&&(this.topOffset=l*(i-1))}}};function d(t,e,s,l,f,i){return o.openBlock(),o.createElementBlock("div",{id:"entryPoint",style:o.normalizeStyle(["width:"+s.width+";height:"+f.height+";background: url("+s.image+");background-size:"+f.scale*100+"% ;background-repeat:no-repeat;background-position:-"+f.leftOffset+"px -"+f.topOffset+"px",{"background-color":"white"}]),onTouchend:e[0]||(e[0]=o.withModifiers((...h)=>i.gestureEnd&&i.gestureEnd(...h),["prevent"])),onTouchstart:e[1]||(e[1]=o.withModifiers((...h)=>i.gestureStart&&i.gestureStart(...h),["prevent"])),onTouchmove:e[2]||(e[2]=o.withModifiers((...h)=>i.gestureMove&&i.gestureMove(...h),["prevent"])),onMousedown:e[3]||(e[3]=(...h)=>i.panStart&&i.panStart(...h)),onMousemove:e[4]||(e[4]=(...h)=>i.panMove&&i.panMove(...h)),onMouseup:e[5]||(e[5]=h=>f.firstTouches=f.touches=[]),onWheel:e[6]||(e[6]=(...h)=>i.mouseWheel&&i.mouseWheel(...h)),ref:"pz"},null,36)}var m=g(a,[["render",d]]);n.PinchZoom3=m,Object.defineProperties(n,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
